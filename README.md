# 微信群成员分析工具

这是一个用于分析微信群成员分布情况的自动化工具。该工具可以自动统计群成员的城市分布，识别管理员，并生成可视化的统计报告。

## 功能特点

- 自动获取微信群成员信息
- 分析成员的城市分布情况
- 识别并统计马哥教育管理员
- 生成文字统计报告
- 生成城市分布柱状图
- 将统计结果转换为图片格式

## 环境要求

- Windows 操作系统
- Python 3.x
- PC 版微信（需要保持登录状态）
- Windows 默认黑体字体（用于生成图片）

## 安装依赖

```bash
pip install -r requirements.txt
```

主要依赖包括：
- wxauto==4.1.6
- pandas==2.1.1
- matplotlib==3.8.0
- pillow==10.0.1

## 使用方法

1. 确保 PC 版微信已登录并保持运行状态
2. 运行程序：
   ```bash
   python wechat_group_analysis.py
   ```
3. 根据提示输入要分析的微信群名称
4. 等待程序自动完成分析

## 输出结果

程序会生成两个文件：
- `group_analysis.png`：包含详细的群成员统计信息
- `city_statistics.png`：显示各城市成员数量的柱状图

## 注意事项

1. 群成员命名格式要求：
   - 普通成员格式：`学号-城市-昵称`
   - 管理员昵称中需包含"马哥"字样

2. 运行注意事项：
   - 确保微信窗口没有被最小化
   - 运行过程中不要操作微信窗口
   - 确保有足够的磁盘空间保存生成的图片

## 代码结构

主要类：`WeChatGroupAnalyzer`

核心方法：
- `get_group_members()`: 获取群成员信息
- `analyze_members()`: 分析成员数据
- `generate_text_result()`: 生成文本统计
- `create_bar_chart()`: 生成柱状图
- `create_result_image()`: 生成统计图片

## 常见问题

1. 如果无法获取群成员信息：
   - 检查微信是否正常登录
   - 确认群名称输入是否正确
   - 确保微信窗口未被最小化

2. 如果图片生成失败：
   - 检查是否安装了 Windows 默认黑体字体
   - 确保程序有写入文件的权限

## 技术支持

如果遇到问题，请检查：
1. 依赖包是否正确安装
2. 微信客户端是否正常运行
3. 运行环境是否满足要求 